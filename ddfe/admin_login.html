<!DOCTYPE html>
<html>
<head>
	<title>Admin</title>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
  	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" type="text/css" href="PublicCSS/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="PublicCSS/bootstrap-theme.min.css">
	<script src="PublicJs/jquery.js"></script>
	<script src="PublicJs/http.js"></script>
	<script src="PublicJs/jQuery.md5.js"></script>
</head>
<body>
	<div id="loginDiv" style="padding:20px;background-color: #e9e9e9;">
		<input type="text" id="username" placeholder="用户名" required="" autofocus="">

		<input type="password" id="password" placeholder="密码" required="">
		<button class="btn btn-xs btn-success" type="button" onclick="user.login()">登陆</button>
    </div>

    <!-- 内容输出 -->
    <div class="container" id="output"></div>

<script>
var requestfront_admin = "../ddbe/api.admin.php?";
var requestfront_be = "../ddbe/api.php?";

$(document).ready(function(){
	user.vertify();
});

var user = {
	vertify : function() {
		var resqurl = requestfront_admin + "action=admin_vertifytoken";
		http_method.ajaxmethod(resqurl,null,"GET","json",callback.finishvertify);
	},
	login : function() {
		var wx_admin_user = $("#username").val();
		var wx_admin_pass = $.md5($('#password').val());

		var resqurl = requestfront_admin + "action=admin_login";

		data = {
			wx_admin_user : wx_admin_user,
			wx_admin_pass : wx_admin_pass,
		};

		http_method.ajaxmethod(resqurl,data,"POST","json",callback.finishlogin);
	}
};

var callback = {
	finishvertify : function(result) {
		if (result.resp == 'false' || result.resp == false ) {
			alert("请登录");
		} else {
			$("#loginDiv").hide();
		}
	},
	finishlogin : function(result) {
		if (result.resp == 'false' || result.resp == false ) {
			alert("用户名或者密码错误，请重新登陆");
		} else {
			$("#loginDiv").hide();
		}
	},
};

</script>

</body>
</html>